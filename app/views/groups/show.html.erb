<div class="uk-height-viewport uk-responsive-width">
  <div class="uk-container-center">
    <div class="uk-panel uk-panel-box">
      <h3 class="uk-panel-title"><%= @group.name %></h3>
      <h2 class="uk-h2">Kör adatai</h2>
      <table>
        <tbody>
          <tr>
            <th class="group-attr">Név</th>
            <td><%= @group.name %></td>
          </tr>
          <tr>
            <th class="group-attr">Alapítási éve</th>
            <td><%= @group.founded %></td>
          </tr>
          <tr>
            <th class="group-attr">Svie tag</th>
            <td><%= @group.issvie ? "Igen" : "Nem" %></td>
          </tr>
          <tr>
            <th class="group-attr">Weboldal</th>
            <td><%= @group.webpage %></td>
          </tr>
          <tr>
            <th class="group-attr">Levelezőlista</th>
            <td><%= @group.maillist %></td>
          </tr>
          <tr>
            <th class="group-attr">Bemutatkozás</th>
            <td><%= @group.description %></td>
          </tr>
        </tbody>
      </table>
      <% if is_leader %>
        <%= link_to 'Adatok szerkesztése', edit_group_path(@group), class: 'uk-button uk-button-primary' %>
      <% end %>
      <% if @group.users_can_apply && !@own_membership %>
        <%= form_tag group_memberships_path(@group), {method: 'post'} do %>
          <%= button_tag "Jelentkezés körbe", {class: "uk-button uk-button-primary"} %>
        <% end %>

      <% end %>
      <h2 class="uk-h2">Aktív tagok</h2>
      <table class="uk-table uk-table-striped uk-table-hover">
        <thead>
          <tr>
            <th>Név</th>
            <th>Becenév</th>
            <th>Betöltött poszt</th>
            <th>Tagság kezdete</th>
            <% if is_leader %>
              <th>Posztok állítása</th>
              <th>Öregtaggá avatás</th>
              <th>Törlés</th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @group.memberships.select{ |m| !m.end }.each do |membership| %>
          <% member = membership.user %>
          <tr>
            <td><%= member.full_name %></td>
            <td><%= member.nickname %></td>
            <td>
              <%= membership.post_types.map(&:pttip_name).join(', ') %>
            </td>
            <td><%= l membership.start %></td>
            <% if is_leader %>
              <td></td>
              <td>
                <%= button_to "Öreggé avatás", group_membership_inactivate_path(@group.id, membership.id),
                 method: :post, class: "uk-button uk-button-primary uk-button-small", remote: true %>
              </td>
              <td>
                <%= button_to "Törlés", group_membership_path(@group.id, membership.id),
                method: :delete, data: {confirm: "Biztos vagy benne?"},
                class: "uk-button-small uk-button-danger uk-button", remote: true %>
              </td>
            <% end %>
          </tr>
          <% end %>
        </tbody>
      </table>

      <h2 class="uk-h2">Öregtagok</h2>
      <table class="uk-table uk-table-striped uk-table-hover">
        <thead>
          <tr>
            <th>Név</th>
            <th>Becenév</th>
            <th>Betöltött poszt</th>
            <th>Tagság kezdete</th>
            <th>Tagság vége</th>
          </tr>
        </thead>
        <tbody>
          <% @group.memberships.select{ |m| m.end }.each do |membership| %>
          <% member = membership.user %>
          <tr>
            <td><%= member.lastname %> <%= member.firstname %></td>
            <td><%= member.nickname %></td>
            <td>
              <%= membership.post_types.map(&:pttip_name).join(', ') %>
            </td>
            <td><%=l membership.start %></td>
            <td><%=l membership.end %></td>
            <% if is_leader %>
              <td>
                <%= button_to "Újraaktiválás", group_membership_reactivate_path(@group.id, membership.id),
                 method: :post, class: "uk-button uk-button-primary uk-button-small", remote: true %>
              </td>
              <td>
                <%= button_to "Törlés", group_membership_path(@group.id, membership.id),
                method: :delete, data: {confirm: "Biztos vagy benne?"},
                class: "uk-button-small uk-button-danger uk-button", remote: true %>
              </td>
            <% end %>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
