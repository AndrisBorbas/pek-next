<% stylesheet 'groups' %>

<div id="content-main" class="group-container">
  <div class="uk-height-viewport uk-responsive-width">
    <div class="uk-container-center">
      <h1 class="uk-h1"><%= @viewmodel.group.name %></h1>
      <div class="uk-panel uk-panel-box">
        <div class="uk-grid">
          <div class="uk-width-medium-3-4">
            <h2 class="uk-h2">Kör adatai</h2>
            <table>
              <tbody>
                <tr>
                  <th class="uk-text-left">Név</th>
                  <td><%= @viewmodel.group.name %></td>
                </tr>
                <tr>
                  <th class="uk-text-left">Alapítási éve</th>
                  <td><%= @viewmodel.group.founded %></td>
                </tr>
                <tr>
                  <th class="uk-text-left">Svie tag</th>
                  <td><%= @viewmodel.group.issvie ? "Igen" : "Nem" %></td>
                </tr>
                <tr>
                  <th class="uk-text-left">Weboldal</th>
                  <td><%= @viewmodel.group.webpage %></td>
                </tr>
                <tr>
                  <th class="uk-text-left">Levelezőlista</th>
                  <td><%= @viewmodel.group.maillist %></td>
                </tr>
                <tr>
                  <th class="uk-text-left">Körvezető</th>
                  <td><%= @viewmodel.group.leader.user.full_name if @viewmodel.group.leader %></td>
                </tr>
                <tr>
                  <th class="uk-text-left">Bemutatkozás</th>
                  <td><%= @viewmodel.group.description %></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="uk-width-medium-1-4 uk-text-right">
            <% if is_leader %>
            <ul class="uk-list">
              <li class="uk-margin-small"><%= link_to 'Adatok szerkesztése', edit_group_path(@group), class: 'uk-button uk-button-primary uk-width-3-4' %></li>
              <li class="uk-margin-small"><%= link_to 'Küldöttek', group_delegates_path(@group), class: 'uk-button uk-button-primary uk-width-3-4' %></li>
            </ul>
            <% end %>
            <% if @viewmodel.group.users_can_apply && !@own_membership %>
            <%= form_tag group_memberships_path(@viewmodel.group), {method: 'post'} do %>
            <%= button_tag "Jelentkezés körbe", {class: "uk-button uk-button-primary uk-margin-small"} %>
            <% end %>
            <% end %>
          </div>
        </div>

        <h2 class="uk-h2">Aktív tagok</h2>

        <div class="uk-grid uk-grid-medium" data-uk-grid="{gutter: 20}">
          <% active_users do |member| %>
          <div class="uk-width-1-1 uk-width-medium-1-3">
            <div class="uk-panel uk-panel-box dark">

              <div class="uk-panel-title uk-margin-remove uk-grid">
                <div class="uk-width-5-6 uk-padding-remove">
                  <%= link_to member.full_name, profile_path(member.screen_name) %>
                </div>
                <% if @viewmodel.leader? %>
                <div class="uk-width-1-6 uk-padding-remove uk-text-right">
                  <%= form_tag(group_membership_posts_path(@viewmodel.group.id, member.membership_id), method: :get, class: 'uk-form') do %>
                  <%= button_tag "Search", name: nil, class: 'uk-icon-edit uk-button uk-button-small' do %><% end %>
                  <% end %>
                </div>
                <% end %>
              </div>

              <div class="uk-panel-body uk-padding-remove">
                <div class="uk-grid uk-grid-collapse">
                  <div class="uk-width-1-1">
                    <%= member.nickname %>&nbsp;
                  </div>
                  <div class="uk-width-2-3 uk-padding-small uk-text-bold"><%= member.posts %></div>
                  <div class="uk-width-1-3 uk-padding-small uk-text-bold uk-text-right"><%= member.membership_start %> -</div>
                  <% if @viewmodel.leader? %>
                  <div class="uk-width-1-2 uk-padding-remove uk-align-center">
                    <%= button_to "Öreggé avatás", group_membership_inactivate_path(@viewmodel.group.id, member.membership_id),
                    method: :post, class: "uk-button uk-button-primary uk-button-small uk-width-auto", remote: true %>
                  </div>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
          <% end %>
        </div>
        <h2 class="uk-h2">Öregtagok</h2>

        <div class="uk-grid uk-grid-medium" data-uk-grid="{gutter: 20}">
          <% inactive_users do |member| %>
          <div class="uk-width-1-1 uk-width-medium-1-3">
            <div class="uk-panel uk-panel-box dark">
              <div class="uk-panel-title uk-margin-remove">
                <%= link_to member.full_name, profile_path(member.screen_name) %>
              </div>
              <div class="uk-panel-body uk-padding-remove">
                <div class="uk-grid">
                  <div class="uk-width-1-1">
                    <%= member.nickname %>
                  </div>
                  <div class="uk-width-1-2 uk-padding-small uk-text-bold"><%= member.posts %></div>
                  <div class="uk-width-1-2 uk-padding-small uk-text-bold uk-text-right"><%=l member.membership_start %> - <%=l member.membership_end %></div>
                  <% if @viewmodel.leader? %>
                  <div class="uk-width-1-2 uk-padding-remove uk-align-center">
                    <%= button_to "Újraaktiválás", group_membership_reactivate_path(@viewmodel.group.id, member.membership_id),
                    method: :post, class: "uk-button uk-button-primary uk-button-small uk-width-auto", remote: true %>
                  </div>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
          <% end %>
        </div>

      </div>
    </div>
  </div>
</div>
