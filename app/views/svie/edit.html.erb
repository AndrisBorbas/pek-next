<% stylesheet 'profile' %>

<div id="content-main" class="neutral-container">
  <div class="uk-height-viewport uk-responsive-width">
    <h1 class="uk-h1">Elsődleges kör beállítás</h1>
    <div class="uk-container-center uk-panel uk-panel-box">
      <%= form_tag svie_update_path, name: 'membershipform', class: 'uk-form uk-margin-top' do %>
      <div class="uk-grid">

        <div class="uk-width-medium-1-1 uk-width-1-1">
          <h2 class="uk-heading">Elsődleges kör</h2>
        </div>
        <div class="uk-width-medium-1-3 uk-width-1-1 uk-text-center">
          SVIE köreid:
        </div>
        <div class="uk-width-medium-1-3 uk-width-1-1 uk-text-center">
          <!-- Form name should always be given: https://stackoverflow.com/questions/4831848/firefox-ignores-option-selected-selected -->
          <%= select :svie, :primary_membership, @svie_memberships.map { |m| [m.group.name, m.id] },
            selected: current_user.svie_primary_membership %>
        </div>
        <div class="uk-width-medium-1-3 uk-align-center">
          <%= submit_tag 'Mentés', class: 'uk-button uk-width-expand' %>
        </div>
      </div>
      <% end %>
      <% if current_user.svie.member? %>
      <div class="uk-width-medium-1-1">
        <hr>
        <div class="uk-grid">
          <h2 class="uk-width-medium-3-4">
            SVIE tagságod típusa: <%=Rails.configuration.x.svie_member_types[ current_user.svie_member_type] %>
          </h2>
          <div class="uk-width-medium-1-4">
            <%= button_to 'Tagság megszüntetése', { action: :destroy }, class: 'uk-button uk-width-expand uk-button-danger', data: { confirm: 'Biztos vagy benne?', disable_with: 'töltés...' } %>
          </div>
        </div>
      </div>

      <div class="uk-grid uk-margin">
        <div class="uk-width-medium-1-1 uk-width-1-1">
          <% if current_user.svie.can_join_to?('OREGTAG') %>
            <div class="uk-grid">
              <div class="uk-width-medium-2-3">
                Öregtaggá válás kezdeményezése
              </div>
              <div class="uk-width-medium-1-3">
                <%= button_to 'Kérvény leadása', { action: :inactivate }, class: 'uk-button uk-width-expand uk-button-primary', data: { confirm: 'Biztos vagy benne?', disable_with: 'töltés...' } %>
              </div>
            </div>
          <% end %>

          <% if current_user.svie.can_join_to?('KULSOSTAG') %>
            <div class="uk-grid">
              <div class="uk-width-medium-2-3">
                Külsős taggá válás kezdeményezése
              </div>
              <div class="uk-width-medium-1-3">
                <%= button_to 'Kérvény leadása', { action: :outside }, class: 'uk-button uk-width-expand uk-button-primary', data: { confirm: 'Biztos vagy benne?', disable_with: 'töltés...' } %>
              </div>
            </div>
          <% end %>

          <% if current_user.svie.can_join_to?('BELSOSTAG') %>
            <div class="uk-grid">
              <div class="uk-width-medium-2-3">
                Belsős taggá válás kezdeményezése
              </div>
              <div class="uk-width-medium-1-3">
                <%= button_to 'Kérvény leadása', { action: :inside }, class: 'uk-button uk-width-expand uk-button-primary', data: { confirm: 'Biztos vagy benne?', disable_with: 'töltés...' } %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
      <% end %>
      <% if current_user.svie.in_processing? %>
        <h2>
          <%= Rails.configuration.x.svie_member_types[current_user.svie_post_request.member_type] %>gá válási kérvényed feldolgozás alatt van.
        </h2>
        <p>A regisztrációs folyamat befejezéséhez két lehetőséged van: Ha ki tudod nyomtatni, akkor aláírod a kérvényt és leadod Katalinnak a Schönherz 1719-es irodájában (megtehetitek, hogy többet adtok le egyszerre, nem kell személyesen jelen lenni).</p>
        <p>Ha nem tudod vagy nem akarod kinyomtatni, akkor keresd Katalint a Schönherz 1719-es irodájában, ő kinyomtatja helyetted, ekkor viszont ott kell lenned személyesen, hogy alá tudd írni.</p>

        <%= button_to "Kérvény letöltése", svie_pdf_path, method: :get, class: "uk-button uk-button-success uk-align-center"%>
      <% end %>
    </div>
  </div>
</div>
